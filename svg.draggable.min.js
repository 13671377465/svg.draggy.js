// svg.draggable.js 0.5 - Copyright (c) 2013 Wout Fierens - Licensed under the MIT license
SVG.extend(SVG.Element,{draggable:function(){var e,t,n,r=this,i=this._parent(SVG.Nested)||this._parent(SVG.Doc);e=function(e){var s,o=i.attr("viewBox"),u=i.attr("width");if(r.beforedrag)r.beforedrag(e);if(r instanceof SVG.G)s={x:r.transform("x"),y:r.transform("y")};else s=r.bbox();r.startEvent=e||window.event;r.startPosition={x:s.x,y:s.y,zoom:1};if(o!=null&&u!=null)r.startPosition.zoom=parseFloat(u)/parseFloat(o.split(" ")[2]);SVG.on(window,"mousemove",t);SVG.on(window,"mouseup",n);if(r.dragstart)r.dragstart({x:0,y:0,zoom:r.startPosition.zoom},e)};t=function(e){if(r.startEvent){var t={x:e.pageX-r.startEvent.pageX,y:e.pageY-r.startEvent.pageY,zoom:r.startPosition.zoom};r.move(r.startPosition.x+t.x/r.startPosition.zoom,r.startPosition.y+t.y/r.startPosition.zoom);if(r.dragmove)r.dragmove(t,e)}};n=function(e){var i={x:e.pageX-r.startEvent.pageX,y:e.pageY-r.startEvent.pageY,zoom:r.startPosition.zoom};r.startEvent=null;r.startPosition=null;SVG.off(window,"mousemove",t);SVG.off(window,"mouseup",n);if(r.dragend)r.dragend(i,e)};r.on("mousedown",e);r.fixed=function(){r.off("mousedown",e);e=t=n=null;return r};return this}});